---
title: "Caio Furlani"
format: html
editor: visual
---

```{r}
#| label: load-packages
#| include: false

library(WDI)
library(dplyr)
library(ggplot2)

options(scipen = 999) # REMOVER A NOT. CIENT.
# DADOS EM PAINEL
dadosAccesstoelectricity <- WDI(country = 'all', indicator = 'EG.ELC.ACCS.ZS')
paises_comparar <- c("BR", "US", "WLD") # BR - Brasil, US - Estados Unidos, WLD - Mundo (World)
dados_paises <- WDI(country = paises_comparar,
                    indicator = 'EG.ELC.ACCS.ZS',
                    start = 2000, end = 2023)

# CORTE TRANSVERSAL
dadosAccesstoelectricity2023 <- WDI(country = 'all',
                                indicator = 'EG.ELC.ACCS.ZS',
                                start = 2023, end = 2023)
dadosAccesstoelectricity2023_clean <- dadosAccesstoelectricity2023 %>%
  filter(!is.na(EG.ELC.ACCS.ZS))
hist_data <- dadosAccesstoelectricity2023_clean %>%
  mutate(bin = cut(EG.ELC.ACCS.ZS, breaks = seq(0, 100, by = 5), right = FALSE)) %>%
  count(bin) %>%
  mutate(mid = as.numeric(sub("\\[|\\)", "", gsub(",.*", "", bin))) + 2.5)

# M√©dia global
media_global <- mean(dadosAccesstoelectricity2023_clean$EG.ELC.ACCS.ZS, na.rm = TRUE)
# S√âRIE TEMPORAL
dadosAccesstoelectricitybr <- WDI(country = 'BR', indicator = 'EG.ELC.ACCS.ZS')

# Removendo valores NA
dadosAccesstoelectricitybr <- na.omit(dadosAccesstoelectricitybr)

# √öltimo valor dispon√≠vel (para anota√ß√£o)
ultimo_ano <- max(dadosAccesstoelectricitybr$year, na.rm = TRUE)
ultimo_valor <- dadosAccesstoelectricitybr %>%
  filter(year == ultimo_ano) %>%
  pull(EG.ELC.ACCS.ZS)
```

## Acasso √° eletricidade no Brasil e mundo

Neste trabalho, escolhi analisar a vari√°vel **Acesso √† Eletricidade**, que representa a porcentagem da popula√ß√£o de um pa√≠s que tem acesso √† energia el√©trica ‚Äî um recurso essencial para a qualidade de vida, desenvolvimento econ√¥mico e social.

As informa√ß√µes utilizadas foram obtidas por meio da base **WDI (World Development Indicators)**, mantida pelo **Banco Mundial**, que re√∫ne estat√≠sticas econ√¥micas e sociais de diversos pa√≠ses ao redor do mundo.

Essa vari√°vel √© fundamental porque mostra **o n√≠vel de infraestrutura b√°sica dispon√≠vel para a popula√ß√£o** e est√° diretamente relacionada a indicadores de sa√∫de, educa√ß√£o, produtividade e bem-estar. O acesso √† eletricidade √© tamb√©m um dos pilares para alcan√ßar os Objetivos de Desenvolvimento Sustent√°vel (ODS), especialmente o ODS 7 ‚Äî "Energia Acess√≠vel e Limpa".

## Gr√°fico em Painel ‚Äì üåçüìà **Compara√ß√£o de Acesso √† Eletricidade: Brasil, EUA e Mundo (2000‚Äì2023)**

O gr√°fico mostra que, entre 2000 e 2023, o **Brasil** ampliou significativamente o acesso √† eletricidade, atingindo quase **100%** da popula√ß√£o, especialmente ap√≥s 2010. Os **Estados Unidos** mantiveram acesso universal ao longo de todo o per√≠odo. J√° a **m√©dia mundial** apresentou crescimento constante, passando de cerca de **75% para mais de 90%**, refletindo avan√ßos globais, mas ainda indicando desigualdades entre pa√≠ses. O Brasil destaca-se por acompanhar os pa√≠ses desenvolvidos nesse indicador.

```{r}
#| label: graficodadosempainel
#| warning: false
#| echo: false

ggplot(dados_paises, aes(x = year, y = EG.ELC.ACCS.ZS, color = country)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  scale_color_manual(values = c("red", "blue", "green")) +
  labs(
    title = "Compara√ß√£o de Acesso √† Eletricidade",
    subtitle = "Brasil, Estados Unidos e Mundo (2000-2023)",
    x = "Ano",
    y = "Acesso √† Eletricidade (%)",
    color = "Pa√≠s"
  ) +
  theme_minimal(base_family = "Helvetica") +
  theme(
    plot.title = element_text(face = "bold", size = 18, hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "gray40"),
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 10)
  )
```

## Grafico de dados de Corte Transversal -**An√°lise da Distribui√ß√£o do Acesso √† Eletricidade nos Pa√≠ses (2023)**

O histograma mostra a distribui√ß√£o dos pa√≠ses em rela√ß√£o ao **percentual da popula√ß√£o com acesso √† eletricidade** no ano de **2023**. Observamos uma **distribui√ß√£o assim√©trica √† esquerda (assimetria negativa)**, com a **maior parte dos pa√≠ses concentrados nas faixas de 90% a 100% de cobertura**.

Isso indica que:

-    **A maioria dos pa√≠ses j√° alcan√ßou um alto n√≠vel de acesso √† eletricidade**, refletindo os avan√ßos globais em infraestrutura el√©trica.

-    Ainda h√° uma **quantidade menor, mas significativa, de pa√≠ses com cobertura abaixo de 80%**, o que aponta **desigualdades no desenvolvimento energ√©tico**, geralmente associadas a pa√≠ses de baixa renda, conflitos armados ou desafios geogr√°ficos (como ilhas e regi√µes remotas).

-    A presen√ßa de pa√≠ses nas faixas mais baixas (abaixo de 60%) mostra que, embora o progresso global seja grande, **a universaliza√ß√£o do acesso ainda n√£o foi atingida em escala mundial**.

-    Esse tipo de an√°lise √© crucial para **identificar prioridades de a√ß√£o internacional**, especialmente no contexto dos Objetivos de Desenvolvimento Sustent√°vel (ODS), como o ODS 7 ‚Äì Energia Acess√≠vel e Limpa.

```{r}
#| label: graficocortetransversal
#| warning: false
#| echo: false

ggplot() +
  geom_histogram(data = dadosAccesstoelectricity2023_clean, 
                 aes(x = EG.ELC.ACCS.ZS), 
                 binwidth = 5, fill = "#69b3a2", color = "white", alpha = 0.8) +
  geom_text(data = hist_data, 
            aes(x = mid, y = n + 1, label = n), 
            color = "black", size = 4) +
  geom_density(data = dadosAccesstoelectricity2023_clean, 
               aes(x = EG.ELC.ACCS.ZS, y = ..count.. * 5), 
               color = "#1f78b4", size = 1, linetype = "dashed") +
  geom_vline(xintercept = media_global, 
             color = "red", linetype = "dotted", size = 1) +
  annotate("text", x = media_global + 1, y = max(hist_data$n) + 5,
           label = paste0("M√©dia Global: ", round(media_global, 1), "%"),
           color = "red", size = 4, hjust = 0) +
  labs(
    title = "Distribui√ß√£o do Acesso √† Eletricidade entre os Pa√≠ses",
    subtitle = "Ano de 2023 ‚Äî Porcentagem da popula√ß√£o com acesso",
    x = "Acesso √† Eletricidade (%)",
    y = "N√∫mero de Pa√≠ses"
  ) +
  scale_x_continuous(breaks = seq(0, 100, 10)) +
  theme_minimal(base_family = "Helvetica") +
  theme(
    plot.title = element_text(face = "bold", size = 18, hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "gray40"),
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 11)
  )
```

## Gr√°fico de dados de S√©rie Temporal - **Evolu√ß√£o do Acesso √† Eletricidade no Brasil (2000‚Äì2023)**

Entre os anos de **2000 e 2023**, o Brasil apresentou uma **evolu√ß√£o constante e significativa** no percentual da popula√ß√£o com acesso √† eletricidade. No in√≠cio dos anos 2000, o acesso j√° era elevado, com mais de **90% da popula√ß√£o coberta**, refletindo o est√°gio avan√ßado da infraestrutura energ√©tica nacional em compara√ß√£o com a m√©dia global.

Ao longo das duas √∫ltimas d√©cadas, o Brasil conseguiu **reduzir desigualdades regionais** e ampliar a cobertura el√©trica em √°reas rurais e isoladas, alcan√ßando **valores pr√≥ximos de 100% nos anos mais recentes**. O gr√°fico mostra uma tend√™ncia de crescimento **quase linear**, com **pouca varia√ß√£o negativa**, o que indica **pol√≠ticas p√∫blicas consistentes**, como os programas "Luz para Todos" e investimentos em redes de transmiss√£o.

O √∫ltimo dado dispon√≠vel, de **2023**, confirma que o Brasil est√° **muito pr√≥ximo da universaliza√ß√£o do acesso √† eletricidade**, o que √© um marco importante para o desenvolvimento econ√¥mico e social.

```{r}
#| label: graficoserietemporal
#| warning: false
#| echo: false

ggplot(dadosAccesstoelectricitybr, 
                                            aes(x = year, y = EG.ELC.ACCS.ZS)) +
  geom_area(fill = "#D6EAF8", alpha = 0.5) +  # √°rea sob a curva
  geom_line(color = "#2980B9", size = 1.4) +  # linha principal
  geom_point(color = "#1B4F72", size = 2) +   # pontos reais
  geom_smooth(method = "loess", se = FALSE, linetype = "dotted", color = "gray40") + # tend√™ncia
  
  # Anota√ß√£o do √∫ltimo valor
  geom_text(aes(x = ultimo_ano, y = ultimo_valor, 
                label = paste0(round(ultimo_valor, 1), "%")), 
            vjust = -1, hjust = 1.1, size = 4.5, color = "#1B4F72", fontface = "bold") +
  
  # T√≠tulos e r√≥tulos
  labs(
    title = "üìà Acesso √† Eletricidade no Brasil (2000‚Äì2023)",
    subtitle = "Evolu√ß√£o percentual da popula√ß√£o com acesso √† eletricidade",
    x = "Ano",
    y = "Popula√ß√£o com Acesso √† Eletricidade (%)",
    caption = "Fonte: World Bank (WDI) ‚Ä¢ Indicador: EG.ELC.ACCS.ZS"
  ) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme_minimal(base_family = "Helvetica") +
  theme(
    plot.title = element_text(face = "bold", size = 18, hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "#7f8c8d"),
    plot.caption = element_text(size = 9, hjust = 1, color = "gray50"),
    axis.title = element_text(size = 13),
    axis.text = element_text(size = 10),
    panel.grid.minor = element_blank()
  )
```
